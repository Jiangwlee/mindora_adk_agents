# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

Mindora ADK Agents is an intelligent agent platform built on Google ADK Agents. The project uses a Next.js + FastAPI + Google ADK technology stack with a multi-app web interface for users to interact with different intelligent agent applications.

## Project Structure

```
mindora_adk_agents/
├── frontend/                    # Next.js multi-app web interface (empty)
├── backend/
│   ├── api/
│   │   └── adk_web_server.py   # ADK web server implementation
│   ├── fast_api.py            # FastAPI application setup
│   ├── agents/                # Agent implementations
│   └── run.py                 # Server startup script
├── docs/
│   └── design.md              # Design documentation
├── .venv/                     # Python virtual environment
├── run_server.py              # Main server entry point
├── pyproject.toml             # Python project configuration
├── .python-version            # Python version specification
├── justfile                   # Command shortcuts (currently empty)
└── README.md                  # Project documentation
```

## Technology Stack

- **Frontend**: Next.js for multi-app web interface (currently empty)
- **Backend**: FastAPI using Google ADK's built-in FastAPI server
- **Agents**: Google ADK Agents (reference: https://github.com/google/adk-samples)
- **Python**: Requires Python 3.12+
- **Virtual Environment**: Uses .venv/ directory

## Dependencies Management

- **Python**: Uses `pyproject.toml` with `google-adk>=1.9.0` dependency
- **Package Manager**: Uses `uv` for dependency management and virtual environment
- **JavaScript**: Use `npm` for dependency management (frontend not implemented)
- **Commands**: Use `justfile` for shortcut commands
- **Environment**: Uses `.venv/` virtual environment with Python 3.12+

## Development Commands

Use `just` command to run common tasks:

- `just install` - Install dependencies
- `just run` - Run FastAPI server
- `just run-web` - Run FastAPI server with web interface
- `just test` - Test imports
- `just deps` - Check dependencies
- `just dev` - Development server with hot reload

## Project Setup

1. Ensure `uv` is installed: `curl -LsSf https://astral.sh/uv/install.sh | sh`
2. Install dependencies: `just install` or `uv sync`
3. Run the server: `python run_server.py` or `just run`
4. Test imports: `just test`

## API Testing

The backend server provides comprehensive API endpoints for agent interaction:

### Main Endpoints
- `GET /list-apps` - List available agent applications
- `POST /run` - Run agent with message (synchronous)
- `POST /run_sse` - Run agent with SSE streaming
- `GET /docs` - Interactive API documentation

### Session Management
- `POST /apps/{app_name}/users/{user_id}/sessions` - Create session
- `GET /apps/{app_name}/users/{user_id}/sessions` - List sessions
- `GET /apps/{app_name}/users/{user_id}/sessions/{session_id}` - Get session details

### Artifact Service
- `GET /apps/{app_name}/users/{user_id}/sessions/{session_id}/artifacts` - List artifacts
- `GET /apps/{app_name}/users/{user_id}/sessions/{session_id}/artifacts/{artifact_name}` - Get artifact

### Debug & Monitoring
- `GET /debug/trace/session/{session_id}` - Get session trace data
- `GET /debug/trace/{event_id}` - Get specific event trace

### Testing Example
```bash
# Start server
python run_server.py

# Test endpoints
curl http://localhost:8000/list-apps
curl -X POST http://localhost:8000/apps/adk_demo/users/test_user/sessions
curl -X POST http://localhost:8000/run -H "Content-Type: application/json" -d '{"appName":"adk_demo","userId":"test_user","sessionId":"SESSION_ID","newMessage":{"role":"user","parts":[{"text":"Hello"}]}}'
```

## Key Implementation Details

### FastAPI Integration
The backend includes a complete FastAPI implementation using Google ADK's built-in FastAPI server:

- **`backend/fast_api.py`**: Contains `get_fast_api_app()` function that creates a FastAPI application with ADK integration
- **`backend/api/adk_web_server.py`**: Contains the `AdkWebServer` class that handles agent execution, session management, and API endpoints

### Core Features Implemented
- **Agent Management**: List, load, and run agents from the agents directory
- **Session Management**: Create, manage, and delete user sessions
- **Artifact Service**: Store and retrieve artifacts generated by agents
- **Memory Service**: In-memory and Vertex AI memory integration
- **Evaluation System**: Create and run evaluation sets for agents
- **WebSocket Support**: Real-time agent communication via WebSocket
- **SSE Streaming**: Server-sent events for streaming agent responses
- **A2A Support**: Agent-to-Agent communication protocol support
- **CORS Support**: Configurable CORS middleware
- **OpenTelemetry**: Distributed tracing support

### Agent Development
Agent implementations should reference examples from:
- https://github.com/google/adk-samples

## Development Notes

- The project has a complete backend implementation but empty frontend
- The `pyproject.toml` exists but has no dependencies listed
- The `justfile` exists but contains no commands yet
- The backend implements the full ADK web server API with session management, artifact handling, and evaluation capabilities
- Development workflow commands should be added to the justfile as the project progresses
- The project uses a Chinese-language README but code and documentation should be in English

## Server Status

The backend server is fully functional and tested:
- ✅ All core endpoints working correctly
- ✅ Agent execution and session management operational
- ✅ SSE streaming and debug tracing functional
- ✅ Available agents: `adk_demo`, `assistant`
- ✅ Default server runs on `http://localhost:8000`